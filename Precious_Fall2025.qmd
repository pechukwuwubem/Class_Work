---
title: "PC_DisEco_Fall2025"
author: "Precious"
format: html
execute: 
  echo: true
---

Find area of a circle with radius 5 cm.

Formula: π * r^2

where r is the radius.

```{r}
# Function to calculate the area of a circle
area_of_circle <- function(radius) {
  area <- pi * radius^2
  return(area)
}
radius <- 5 # from the example
circle_area <- area_of_circle(radius)
cat("The area of the circle with radius", radius, "is", circle_area, "\n")
```

## Image

![Epichloë–grass–livestock triad](https://raw.githubusercontent.com/anyadoc/hostfile/main/EpiTriad.png)

The image illustrates the ecological triad among *Epichloë* endophytes, cool‑season forage grasses (such as tall fescue/ryegrass), and mammals that interact with these plants. 
Endophyte-derived alkaloids can deter insect herbivores and influence plant fitness, but some compounds contribute to livestock toxicoses. 
This simple diagram helps frame host–microbe–consumer interactions that motivate genomic and metabolomic analyses in disease ecology and plant pathology.

---

# Worksheet 2: Sample size for disease detection

**Instructions:** I inserted the sample size table (linked) and answered questions 1–3 below using the sample size table and the Rule of 3 as requested. Do not change the filename when you upload this back to GitHub.

![Sample size table](https://raw.githubusercontent.com/anyadoc/audiseco/main/ss_table.png)

### Q1
**Question:** Find the sample size necessary to detect a disease at or above 5% prevalence in a herd of 5000 deer. The desired level of confidence is 95%.

**Answer and work:** Using the sample size table for detection (95% confidence): at **5% prevalence**, the table lists a required sample size of **59** animals.  
**Final answer:** **59 deer**.

---

### Q2
**Question:** Using the hypergeometric distribution, compare the sample size requirements for the following scenarios:

a) 95% confidence in detecting a disease at 1% prevalence in a large population

b) 99% confidence in detecting a disease at 2% prevalence in a large population

**Answer and work:** Using the sample size table / hypergeometric approximations for large populations:

- (a) **95% confidence, 1% prevalence:** required sample size ≈ **299** animals.
- (b) **99% confidence, 2% prevalence:** required sample size ≈ **264** animals.

**Notes:** These values come from the lookup table used in class (ss_table.png). For very large populations the hypergeometric distribution approximates the binomial, and the table provides these common detection-sample-size values.

---

### Q3
**Question:** You sample 300 deer from a high fenced facility that has a herd of 4000. None of the 300 deer have antibodies against Epizootic Hemorrhagic Disease. Based on this finding, you are 95% confident that the prevalence of exposure to EHD in this facility is _____ (<, =, >) ____%.

**Answer and work:** Apply the Rule of 3: when zero positives are observed in a sample of size *n*, the 95% upper confidence limit for prevalence ≈ 3/n. With *n = 300*:

3 / 300 = 0.01 = **1%**.

Therefore you are 95% confident that the prevalence is **< 1%**.

**Final answer:** **< 1%** (95% upper confidence limit = 1%).

---

# Question 1: Sample size for 5% prevalence, 95% confidence, N = 5000
N <- 5000
confidence <- 0.95
p <- 0.05
D <- p * N  # Number of diseased deer
n <- ceiling((log(1 - confidence) / log(1 - p)) * (N - (D / 2)) / N)
cat("Sample size needed:", n, "\n")

# Question 2: Compare sample sizes for large populations
# Scenario a: 95% confidence, 1% prevalence
confidence_a <- 0.95
p_a <- 0.01
n_a <- ceiling(log(1 - confidence_a) / log(1 - p_a))
cat("Sample size for 95% confidence, 1% prevalence:", n_a, "\n")

# Scenario b: 99% confidence, 2% prevalence
confidence_b <- 0.99
p_b <- 0.02
n_b <- ceiling(log(1 - confidence_b) / log(1 - p_b))
cat("Sample size for 99% confidence, 2% prevalence:", n_b, "\n")

# Question 3: Prevalence upper bound using Rule of Three
n <- 300
p_upper <- 3 / n * 100  # Convert to percentage
cat("95% confidence that prevalence is less than or equal to", p_upper, "%\n")

